@import "tailwindcss";

:root {
  --background: #ffffff;
  --foreground: #171717;

  /* Help & Support semantic tokens (#344) */
  --dc-color-interactive-primary: #2563eb;
  --dc-color-interactive-primary-subtle: #eff6ff;
  --dc-color-status-error: #dc2626;
  --dc-color-error-bg: #fef2f2;
  --dc-color-status-success: #059669;
  --dc-color-success-bg: #ecfdf5;
  --dc-color-text-secondary: #374151;
  --dc-color-text-muted: #6b7280;
  --dc-color-text-placeholder: #9ca3af;
  --dc-color-border-strong: #d1d5db;
  --dc-color-surface-secondary: #f9fafb;

  /* Editor Panel — violet accent (#317) */
  --dc-color-interactive-escalation: #7c3aed;
  --dc-color-interactive-escalation-subtle: #f5f3ff;
  --dc-color-interactive-escalation-hover: #6d28d9;
  --dc-color-interactive-escalation-border: #c4b5fd;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-muted-foreground: #6b7280;
  --color-border: #e5e7eb;
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --font-serif: var(--font-lora);
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: var(--font-geist-sans), sans-serif;
}

/* ------------------------------------------------------------------
 * Chapter Editor Styles (US-011)
 *
 * 18px base font size per PRD Section 8.
 * Styles for Tiptap ProseMirror editor content area.
 * ------------------------------------------------------------------ */

.chapter-editor-content {
  font-size: 18px;
  line-height: 1.75;
}

.chapter-editor-content p {
  margin-bottom: 1em;
}

.chapter-editor-content h2 {
  font-size: 1.5em;
  font-weight: 600;
  margin-top: 1.5em;
  margin-bottom: 0.5em;
}

.chapter-editor-content h3 {
  font-size: 1.25em;
  font-weight: 600;
  margin-top: 1.25em;
  margin-bottom: 0.5em;
}

.chapter-editor-content ul,
.chapter-editor-content ol {
  padding-left: 1.5em;
  margin-bottom: 1em;
}

.chapter-editor-content ul {
  list-style-type: disc;
}

.chapter-editor-content ol {
  list-style-type: decimal;
}

.chapter-editor-content li {
  margin-bottom: 0.25em;
}

.chapter-editor-content li p {
  margin-bottom: 0;
}

.chapter-editor-content blockquote {
  border-left: 3px solid #e5e7eb;
  padding-left: 1em;
  margin-left: 0;
  margin-right: 0;
  font-style: italic;
  color: #6b7280;
}

.chapter-editor-content strong {
  font-weight: 600;
}

.chapter-editor-content em {
  font-style: italic;
}

/* ------------------------------------------------------------------
 * Footnote Styles (#196)
 *
 * Footnote references appear as superscript [N] inline with text.
 * Footnote content entries render at the bottom of the chapter,
 * separated by a horizontal rule.
 *
 * Per design-spec.md Decision 9: "[N] Source Title" format.
 * ------------------------------------------------------------------ */

.chapter-editor-content .footnote-ref {
  font-size: 0.75em;
  vertical-align: super;
  line-height: 0;
  color: #2563eb;
  cursor: default;
  font-weight: 500;
  user-select: all;
}

.chapter-editor-content .footnotes {
  margin-top: 1.5em;
  padding-top: 1em;
  font-size: 0.875em;
  color: #6b7280;
  line-height: 1.5;
}

.chapter-editor-content .footnote-content {
  margin-bottom: 0.5em;
  padding-left: 0;
}

.chapter-editor-content .footnote-content::before {
  content: "[" attr(data-footnote-label) "] ";
  font-weight: 600;
  color: #374151;
}

/* Separator between body text and footnotes — the <hr> before .footnotes */
.chapter-editor-content hr + .footnotes {
  border-top: none;
}

.chapter-editor-content hr {
  border: none;
  border-top: 1px solid #e5e7eb;
  margin: 1.5em 0 0;
}

/* Placeholder styling for empty editor */
.chapter-editor-content.is-editor-empty:first-child::before {
  content: attr(data-placeholder);
  color: #9ca3af;
  pointer-events: none;
  position: absolute;
  height: 0;
  float: left;
}

/* Remove focus outline - editor manages its own state */
.chapter-editor-content:focus {
  outline: none;
}

/* Virtual keyboard offset for iPad Safari */
:root {
  --keyboard-height: 0px;
}

.chapter-editor {
  padding-bottom: var(--keyboard-height);
}

/* AI Rewrite Bottom Sheet - slide up animation */
@keyframes slide-up {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.animate-slide-up {
  animation: slide-up 0.3s ease-out;
}

/* AI Rewrite - highlight flash on accepted text replacement */
@keyframes highlight-flash {
  0% {
    background-color: rgba(59, 130, 246, 0.3);
  }
  100% {
    background-color: transparent;
  }
}

.ai-rewrite-highlight {
  animation: highlight-flash 1.5s ease-out;
}

/* ------------------------------------------------------------------
 * Source Content Renderer (Spike #188)
 *
 * Typography for read-only source documents in the Research Panel.
 * Tuned for 340pt-wide panel. Minimum 16px text per AC.
 * ------------------------------------------------------------------ */

.source-content {
  font-size: 16px;
  line-height: 1.7;
  color: #374151;
}

.source-content h1 {
  font-size: 1.5em;
  font-weight: 700;
  margin: 1.5em 0 0.5em;
  font-family: var(--font-serif);
  color: #111827;
}

.source-content h2 {
  font-size: 1.25em;
  font-weight: 600;
  margin: 1.25em 0 0.5em;
  font-family: var(--font-serif);
  color: #111827;
}

.source-content h3 {
  font-size: 1.1em;
  font-weight: 600;
  margin: 1em 0 0.4em;
  font-family: var(--font-serif);
  color: #111827;
}

.source-content p {
  margin-bottom: 1em;
}

.source-content ul,
.source-content ol {
  padding-left: 1.5em;
  margin-bottom: 1em;
}

.source-content ul {
  list-style-type: disc;
}

.source-content ol {
  list-style-type: decimal;
}

.source-content li {
  margin-bottom: 0.25em;
}

.source-content blockquote {
  border-left: 3px solid #e5e7eb;
  padding-left: 1em;
  font-style: italic;
  color: #6b7280;
}

.source-content a {
  color: #2563eb;
  text-decoration: none;
}

.source-content a:hover {
  text-decoration: underline;
}

.source-content strong {
  font-weight: 600;
}

.source-content em {
  font-style: italic;
}

.source-content table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 1em;
  font-size: 0.9em;
}

.source-content th,
.source-content td {
  border: 1px solid #e5e7eb;
  padding: 0.5em 0.75em;
  text-align: left;
}

.source-content th {
  background-color: #f9fafb;
  font-weight: 600;
}

/* Search highlight styles */
.search-highlight {
  background-color: rgba(250, 204, 21, 0.4);
  border-radius: 2px;
}

.search-highlight-active {
  background-color: rgba(250, 204, 21, 0.8);
  box-shadow: 0 0 0 2px rgba(250, 204, 21, 0.6);
}

/* Scroll-to-position flash — distinct from highlight-flash (AI rewrite, line 134) */
@keyframes scroll-target-flash {
  0% {
    background-color: rgba(250, 204, 21, 0.5);
  }
  100% {
    background-color: transparent;
  }
}

.scroll-target-flash {
  animation: scroll-target-flash 1.5s ease-out;
}

/* ------------------------------------------------------------------
 * Sources Panel Animations
 *
 * Panel slides in from the right. Backdrop fades in behind overlay.
 * ------------------------------------------------------------------ */

@keyframes sources-panel-slide-in {
  from {
    transform: translateX(100%);
  }
  to {
    transform: translateX(0);
  }
}

@keyframes sources-backdrop-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.sources-panel-slide-in {
  animation: sources-panel-slide-in 200ms ease-out;
}

.sources-backdrop-fade-in {
  animation: sources-backdrop-fade-in 200ms ease-out;
}

/* Sources Panel safe area handling */
.sources-panel {
  padding-right: env(safe-area-inset-right, 0);
  padding-bottom: env(safe-area-inset-bottom, 0);
}

.sources-panel-overlay {
  height: 100dvh;
  padding-top: env(safe-area-inset-top, 0);
  padding-right: env(safe-area-inset-right, 0);
  padding-bottom: env(safe-area-inset-bottom, 0);
}

/* Sources Panel first-use nudge pulsing dot */
@keyframes sources-nudge-pulse {
  0%,
  100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.6;
    transform: scale(1.3);
  }
}

.sources-nudge-dot {
  animation: sources-nudge-pulse 2s ease-in-out infinite;
}

/* ------------------------------------------------------------------
 * Editor Panel (#317)
 *
 * Panel slides in from the left. Blinking cursor for streaming.
 * Violet accent per Design Charter Section 6 color code.
 * ------------------------------------------------------------------ */

@keyframes editor-panel-slide-in {
  from {
    transform: translateX(-100%);
  }
  to {
    transform: translateX(0);
  }
}

@keyframes editor-panel-backdrop-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.editor-panel-slide-in {
  animation: editor-panel-slide-in 200ms ease-out;
}

.editor-panel-backdrop-fade-in {
  animation: editor-panel-backdrop-fade-in 200ms ease-out;
}

/* Editor Panel safe area handling */
.editor-panel {
  padding-left: env(safe-area-inset-left, 0);
  padding-bottom: env(safe-area-inset-bottom, 0);
}

.editor-panel-overlay {
  height: 100dvh;
  padding-top: env(safe-area-inset-top, 0);
  padding-left: env(safe-area-inset-left, 0);
  padding-bottom: env(safe-area-inset-bottom, 0);
}

/* Streaming cursor blink */
@keyframes editor-cursor-blink {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0;
  }
}

.editor-cursor-blink {
  animation: editor-cursor-blink 1s step-end infinite;
}

/* ------------------------------------------------------------------
 * Toast Notification (#197)
 *
 * Fade-in animation for toast messages.
 * ------------------------------------------------------------------ */

@keyframes toast-fade-in {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.toast-fade-in {
  animation: toast-fade-in 200ms ease-out;
}

/* ------------------------------------------------------------------
 * Floating Selection Toolbar (#197)
 *
 * Scale-in animation for the text selection toolbar.
 * ------------------------------------------------------------------ */

@keyframes toolbar-scale-in {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.toolbar-scale-in {
  animation: toolbar-scale-in 150ms ease-out;
}

/* ------------------------------------------------------------------
 * Workspace View Transition (#318)
 *
 * Crossfade animation for switching between Chapter and Book views.
 * Per AC: 300ms ease-in-out crossfade for center area.
 * ------------------------------------------------------------------ */

@keyframes workspace-view-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes workspace-view-fade-out {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

.workspace-view-enter {
  animation: workspace-view-fade-in 300ms ease-in-out;
}

.workspace-view-exit {
  animation: workspace-view-fade-out 300ms ease-in-out;
}

/* ------------------------------------------------------------------
 * Onboarding Tooltip Animations (#337)
 *
 * Entrance/exit animations for redesigned tooltips.
 * ------------------------------------------------------------------ */

@keyframes tooltip-enter {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes tooltip-exit {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.95);
  }
}

.tooltip-enter {
  animation: tooltip-enter 200ms ease-out;
}

.tooltip-exit {
  animation: tooltip-exit 150ms ease-in forwards;
}

/* ------------------------------------------------------------------
 * Feedback Sheet Animation (#338)
 *
 * Bottom sheet slides up from below viewport.
 * ------------------------------------------------------------------ */

@keyframes sheet-slide-up {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.sheet-slide-up {
  animation: sheet-slide-up 300ms ease-out;
}

/* Respect prefers-reduced-motion */
@media (prefers-reduced-motion: reduce) {
  .animate-slide-up {
    animation: none;
  }

  .ai-rewrite-highlight {
    animation: none;
  }

  .scroll-target-flash {
    animation: none;
  }

  .sources-panel-slide-in {
    animation: none;
  }

  .sources-backdrop-fade-in {
    animation: none;
  }

  .sources-nudge-dot {
    animation: none;
  }

  .toast-fade-in {
    animation: none;
  }

  .toolbar-scale-in {
    animation: none;
  }

  .workspace-view-enter,
  .workspace-view-exit {
    animation: none;
  }

  .workspace-overlay-slide-left,
  .workspace-overlay-slide-right {
    animation: none;
  }

  .workspace-overlay-backdrop {
    animation: none;
  }

  .tooltip-enter {
    animation: none;
  }

  .tooltip-exit {
    animation: none;
  }

  .sheet-slide-up {
    animation: none;
  }

  .editor-panel-slide-in {
    animation: none;
  }

  .editor-panel-backdrop-fade-in {
    animation: none;
  }

  .editor-cursor-blink {
    animation: none;
    /* Keep cursor visible but static */
    opacity: 1;
  }
}

/* ------------------------------------------------------------------
 * WorkspaceShell CSS Grid Layout System (#316)
 *
 * Responsive workspace layout with four named grid areas:
 * - sidebar: Chapter navigation (left)
 * - editor-panel: Source/assist panel (left of center)
 * - center: Main writing area (never < 400px)
 * - library-panel: Library/desk panel (right)
 *
 * Breakpoints per Design Brief:
 * - Portrait (768-1023px): sidebar collapsed, panels as overlays
 * - Landscape (1024-1279px): sidebar persistent, one panel persistent
 * - Desktop (1280px+): sidebar persistent, both panels can be persistent
 *
 * Uses 100dvh for Safari dynamic viewport, env() for safe areas.
 * ------------------------------------------------------------------ */

/* ---------------------------------------------------------------------
 * CSS Custom Properties for Layout
 * --------------------------------------------------------------------- */

:root {
  /* Sidebar dimensions */
  --workspace-sidebar-width: 260px;
  --workspace-sidebar-min-width: 240px;
  --workspace-sidebar-max-width: 280px;

  /* Panel dimensions */
  --workspace-panel-width: 320px;
  --workspace-panel-min-width: 280px;
  --workspace-panel-max-width: 380px;

  /* Center area constraint - NEVER collapses below this */
  --workspace-center-min-width: 400px;

  /* Header height (from protected layout) */
  --workspace-header-height: 3.5rem;

  /* Safe area insets */
  --workspace-safe-top: env(safe-area-inset-top, 0px);
  --workspace-safe-right: env(safe-area-inset-right, 0px);
  --workspace-safe-bottom: env(safe-area-inset-bottom, 0px);
  --workspace-safe-left: env(safe-area-inset-left, 0px);
}

/* ---------------------------------------------------------------------
 * Main Shell Container
 * --------------------------------------------------------------------- */

.workspace-shell {
  display: grid;
  height: calc(100dvh - var(--workspace-header-height));
  width: 100%;
  overflow: hidden;
  background: var(--background);

  /* Safe area padding */
  padding-left: var(--workspace-safe-left);
  padding-right: var(--workspace-safe-right);
  padding-bottom: var(--workspace-safe-bottom);

  /* Enable container queries on this element */
  container-type: inline-size;
  container-name: workspace;
}

/* ---------------------------------------------------------------------
 * Portrait Breakpoint (768-1023px)
 *
 * - Sidebar: collapsed to pill (not in grid)
 * - Editor Panel: overlay only (not in grid)
 * - Center: full width
 * - Library Panel: overlay only (not in grid)
 * --------------------------------------------------------------------- */

/* Default/Portrait: single column, center takes all space */
.workspace-shell {
  grid-template-columns: 1fr;
  grid-template-rows: 1fr;
  grid-template-areas: "center";
}

.workspace-sidebar {
  /* In portrait, sidebar is not in grid flow - shown as overlay or pill */
  display: none;
}

.workspace-editor-panel {
  /* In portrait, editor panel is overlay only */
  display: none;
}

.workspace-center {
  grid-area: center;
  min-width: 0; /* Allow shrinking in grid */
  overflow: hidden;

  /* Container query scope for internal component adaptation */
  container-type: inline-size;
  container-name: writing-area;
}

.workspace-library-panel {
  /* In portrait, library panel is overlay only */
  display: none;
}

/* ---------------------------------------------------------------------
 * Landscape Breakpoint (1024-1279px)
 *
 * - Sidebar: persistent, collapsible
 * - Editor Panel: can be persistent OR overlay (not both with library)
 * - Center: min 400px, flexible
 * - Library Panel: can be persistent OR overlay (not both with editor)
 * --------------------------------------------------------------------- */

@media (min-width: 1024px) {
  .workspace-shell {
    /* Two columns: sidebar + flexible center area */
    grid-template-columns: var(--workspace-sidebar-width) 1fr;
    grid-template-rows: 1fr;
    grid-template-areas: "sidebar center";
  }

  .workspace-sidebar {
    display: flex;
    flex-direction: column;
    grid-area: sidebar;
    min-width: var(--workspace-sidebar-min-width);
    max-width: var(--workspace-sidebar-max-width);
    border-right: 1px solid var(--color-border);
    background: #f9fafb;
    overflow: hidden;
  }

  /* Sidebar collapsed state */
  .workspace-shell[data-sidebar-collapsed="true"] {
    grid-template-columns: 0 1fr;
  }

  .workspace-shell[data-sidebar-collapsed="true"] .workspace-sidebar {
    display: none;
  }

  /* Single panel persistent (either editor OR library, not both) */
  .workspace-shell[data-editor-panel="persistent"] {
    grid-template-columns: var(--workspace-sidebar-width) var(--workspace-panel-width) 1fr;
    grid-template-areas: "sidebar editor-panel center";
  }

  .workspace-shell[data-editor-panel="persistent"] .workspace-editor-panel {
    display: flex;
    flex-direction: column;
    grid-area: editor-panel;
    min-width: var(--workspace-panel-min-width);
    max-width: var(--workspace-panel-max-width);
    border-right: 1px solid var(--color-border);
    overflow: hidden;

    /* Container query scope */
    container-type: inline-size;
    container-name: editor-panel;
  }

  .workspace-shell[data-library-panel="persistent"] {
    grid-template-columns: var(--workspace-sidebar-width) 1fr var(--workspace-panel-width);
    grid-template-areas: "sidebar center library-panel";
  }

  .workspace-shell[data-library-panel="persistent"] .workspace-library-panel {
    display: flex;
    flex-direction: column;
    grid-area: library-panel;
    min-width: var(--workspace-panel-min-width);
    max-width: var(--workspace-panel-max-width);
    border-left: 1px solid var(--color-border);
    overflow: hidden;

    /* Container query scope */
    container-type: inline-size;
    container-name: library-panel;
  }

  /* Panel layout algorithm: ensure center never < 400px in landscape */
  /* When both panels try to be persistent, only one can be */
  .workspace-shell[data-editor-panel="persistent"][data-library-panel="persistent"] {
    /* In landscape, if both want to be persistent, library becomes overlay */
    grid-template-columns: var(--workspace-sidebar-width) var(--workspace-panel-width) 1fr;
    grid-template-areas: "sidebar editor-panel center";
  }

  .workspace-shell[data-editor-panel="persistent"][data-library-panel="persistent"]
    .workspace-library-panel {
    /* Library panel forced to overlay in landscape when editor is persistent */
    display: none;
  }
}

/* ---------------------------------------------------------------------
 * Desktop Breakpoint (1280px+)
 *
 * - Sidebar: always persistent
 * - Editor Panel: can be persistent alongside library
 * - Center: flexible, min 400px
 * - Library Panel: can be persistent alongside editor
 * --------------------------------------------------------------------- */

@media (min-width: 1280px) {
  .workspace-shell {
    /* Sidebar + flexible center */
    grid-template-columns: var(--workspace-sidebar-width) 1fr;
    grid-template-areas: "sidebar center";
  }

  /* Both panels can now be persistent */
  .workspace-shell[data-editor-panel="persistent"][data-library-panel="persistent"] {
    grid-template-columns:
      var(--workspace-sidebar-width)
      var(--workspace-panel-width)
      minmax(var(--workspace-center-min-width), 1fr)
      var(--workspace-panel-width);
    grid-template-areas: "sidebar editor-panel center library-panel";
  }

  .workspace-shell[data-editor-panel="persistent"][data-library-panel="persistent"]
    .workspace-library-panel {
    /* Library panel now visible in desktop */
    display: flex;
    flex-direction: column;
    grid-area: library-panel;
    min-width: var(--workspace-panel-min-width);
    max-width: var(--workspace-panel-max-width);
    border-left: 1px solid var(--color-border);
    overflow: hidden;
    container-type: inline-size;
    container-name: library-panel;
  }

  /* Single editor panel */
  .workspace-shell[data-editor-panel="persistent"]:not([data-library-panel="persistent"]) {
    grid-template-columns:
      var(--workspace-sidebar-width)
      var(--workspace-panel-width)
      minmax(var(--workspace-center-min-width), 1fr);
    grid-template-areas: "sidebar editor-panel center";
  }

  /* Single library panel */
  .workspace-shell[data-library-panel="persistent"]:not([data-editor-panel="persistent"]) {
    grid-template-columns:
      var(--workspace-sidebar-width)
      minmax(var(--workspace-center-min-width), 1fr)
      var(--workspace-panel-width);
    grid-template-areas: "sidebar center library-panel";
  }
}

/* ---------------------------------------------------------------------
 * Overlay Components
 *
 * For panels in overlay mode (portrait, or second panel in landscape)
 * --------------------------------------------------------------------- */

.workspace-overlay-container {
  position: fixed;
  inset: 0;
  z-index: 50;
}

.workspace-overlay-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.3);
  animation: workspace-backdrop-fade-in 200ms ease-out;
}

@keyframes workspace-backdrop-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.workspace-overlay-panel {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 100%;
  max-width: var(--workspace-panel-max-width);
  background: var(--background);
  box-shadow:
    0 20px 25px -5px rgba(0, 0, 0, 0.1),
    0 8px 10px -6px rgba(0, 0, 0, 0.1);
  display: flex;
  flex-direction: column;
  overflow: hidden;

  /* Safe area handling */
  padding-top: var(--workspace-safe-top);
  padding-bottom: var(--workspace-safe-bottom);
}

.workspace-overlay-panel.left-0 {
  padding-left: var(--workspace-safe-left);
}

.workspace-overlay-panel.right-0 {
  padding-right: var(--workspace-safe-right);
}

/* Slide animations */
@keyframes workspace-slide-from-left {
  from {
    transform: translateX(-100%);
  }
  to {
    transform: translateX(0);
  }
}

@keyframes workspace-slide-from-right {
  from {
    transform: translateX(100%);
  }
  to {
    transform: translateX(0);
  }
}

.workspace-overlay-slide-left {
  animation: workspace-slide-from-left 200ms ease-out;
}

.workspace-overlay-slide-right {
  animation: workspace-slide-from-right 200ms ease-out;
}

/* ---------------------------------------------------------------------
 * Sidebar Pill (Collapsed State)
 *
 * Shown in portrait mode or when sidebar is manually collapsed
 * --------------------------------------------------------------------- */

.workspace-sidebar-pill {
  position: fixed;
  left: calc(8px + var(--workspace-safe-left));
  top: 50%;
  transform: translateY(-50%);
  z-index: 40;

  /* Styling */
  padding: 8px 12px;
  border-radius: 9999px;
  background: #2563eb;
  color: white;
  font-size: 14px;
  font-weight: 500;
  box-shadow:
    0 4px 6px -1px rgba(0, 0, 0, 0.1),
    0 2px 4px -2px rgba(0, 0, 0, 0.1);

  /* Touch target */
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;

  /* Interaction */
  cursor: pointer;
  transition:
    background 150ms ease,
    transform 150ms ease;
}

.workspace-sidebar-pill:hover {
  background: #1d4ed8;
}

.workspace-sidebar-pill:focus {
  outline: none;
  box-shadow:
    0 0 0 3px rgba(37, 99, 235, 0.5),
    0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

.workspace-sidebar-pill:active {
  transform: translateY(-50%) scale(0.95);
}

/* ---------------------------------------------------------------------
 * Container Query Utilities
 *
 * For component-internal adaptation based on container size
 * Safari 16+ supported
 * --------------------------------------------------------------------- */

/* Writing area adaptations */
@container writing-area (max-width: 600px) {
  /* Narrower center area: reduce padding, adjust typography */
  .workspace-center-content {
    padding-left: 16px;
    padding-right: 16px;
  }
}

@container writing-area (min-width: 601px) {
  .workspace-center-content {
    padding-left: 32px;
    padding-right: 32px;
  }
}

@container writing-area (min-width: 800px) {
  .workspace-center-content {
    padding-left: 48px;
    padding-right: 48px;
    max-width: 720px;
    margin-left: auto;
    margin-right: auto;
  }
}

/* Panel adaptations */
@container editor-panel (max-width: 300px) {
  .panel-compact-layout {
    /* Trigger compact mode for narrow panels */
    --panel-padding: 12px;
  }
}

@container library-panel (max-width: 300px) {
  .panel-compact-layout {
    --panel-padding: 12px;
  }
}

/* ---------------------------------------------------------------------
 * Utility Classes for Panel Visibility
 * --------------------------------------------------------------------- */

/* Show/hide based on panel state - for use with data attributes */
.workspace-shell[data-editor-panel="hidden"] .show-when-editor-open {
  display: none;
}

.workspace-shell[data-library-panel="hidden"] .show-when-library-open {
  display: none;
}

.workspace-shell:not([data-editor-panel="hidden"]) .hide-when-editor-open {
  display: none;
}

.workspace-shell:not([data-library-panel="hidden"]) .hide-when-library-open {
  display: none;
}
